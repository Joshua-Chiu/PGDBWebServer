{% extends 'data/base.html' %}

{% load mathfilters %}
{% load staticfiles %}

{% block title %}Graduation Candidates{% endblock %}

{% block navbar %}
    {% include 'data/navbar.html' %}
{% endblock %}

{% block stylesheet %}
    <link rel="stylesheet" href="{% static 'css/reports_styles.css' %}">
{% endblock %}

{% block content%}
    <div>
    <h2 class="heading">Printing Reports</h2>
    </div>

    <form method="get" class="search_bar">
        <fieldset style="border: 0">
            Year: <select name="year" id="year"></select>

            Grade:
            <select name="grade">
                <option value="12">Grade 12</option>
            </select>

            Graduation Awards:
            <select name="grad-awards">
                <option value="" >Select</option>
                <option value="SE">Service Candidates</option>
                <option value="AT">Athletics Candidates</option>
                <option value="SC">Scholar Candidates</option>
                <option value="FA">Fine Arts Candidates</option>
                <option value="ME">Merit Candidates</option>
            </select>

            <input type="submit" value="Enter" onclick="javascript: form.action='print-grad';" />
        </fieldset>
    </form>

    <div>
        <button class="button default" onclick="PrintElem('GradList')">Print Student List</button>
    </div>

    <h2>Service Candidates</h2>
    {% if student_list %}
    <div id="GradList">
        {% for student in student_list %}
            <table>
                <tr>
                    <td>CANDIDATE: </td>
                    <td>{{ student.last }}, {{ student.first }} ({{ student.legal }}) ({{ student.homeroom }})</td>
                </tr>
                {% for i in i|rjust:5 %}
                    {% for grade in student.grade_set.all %}
                        {% ifequal 8|add:forloop.parentloop.counter0 grade.grade|stringformat:"02d"|add:"0" %}
                        <tr>
                            <td>GR {{ grade.grade|stringformat:"02d"|add:"0" }}:</td>
                            <td>
                                {% for point in grade.points_set.all %}
                                    {% ifequal point_type point.type.catagory %}
                                        <span class="point">{{ point.amount }}</span>
                                        <span class="code description">{{ point.type.description }}</span>
                                        <span style="display: inline-block; width: 2ch;">&#9;</span>
                                    {% endifequal %}
                                {% endfor %}
                            </td>
                        </tr>
                        {% endifequal %}
                    {% endfor %}
                {% endfor %}
                <tr>
                    <td>TOTAL:</td>
                    <td>11-12: {% ifequal "SE" point_type %} 
                          {{ student.SE_11_12_total|floatformat:"2" }}
                      {% endifequal %}
                      {% ifequal "AT" point_type %}
                          {{ student.AT_11_12_total|floatformat:"2" }}
                      {% endifequal %} &emsp;
                      {% ifequal "FA" point_type %}
                          {{ student.AT_11_12_total|floatformat:"2" }}
                      {% endifequal %} &emsp;
                      {% ifequal "SC" point_type %}
                          {{ student.SC_11_12_total|floatformat:"2" }}
                      {% endifequal %} &emsp;
                        08-12:
                        {% for grade in student.grade_set.all %}
                            {% ifequal 12 grade.grade|stringformat:"02d"|add:"0" %}
                                {% ifequal "SE" point_type %}
                                    {{ grade.cumulative_SE|floatformat:"2" }}
                                {% endifequal %}
                                {% ifequal "AT" point_type %}
                                    {{ grade.cumulative_AT|floatformat:"2" }}
                                {% endifequal %}
                                {% ifequal "FA" point_type %}
                                    {{ grade.cumulative_FA|floatformat:"2" }}
                                {% endifequal %}
                                {% ifequal "SC" point_type %}
                                    {{ grade.cumulative_SC|floatformat:"2" }}
                                {% endifequal %}
                            {% endifequal %}
                        {% endfor %}
                    </td>
                </tr>
                <tr>
                    <td>PINS:</td>
                    <td>
                        {% if student.silver_pin %}Silver in Grade {{ student.silver_pin }}, {% endif %}
                        {% if student.gold_pin %}Gold in Grade {{ student.gold_pin }}, {% endif %}
                        {% if student.goldPlus_pin %}Gold+ in Grade {{ student.goldPlus_pin }}, {% endif %}
                        {% if student.platinum_pin %}Platinum in Grade {{ student.platinum_pin }}, {% endif %}
                    </td>

                </tr>
            </table>
            <hr>
        {% endfor %}
    </div>
    {% endif %}

{% endblock %}
{% block javascript %}
    <script>
        const start = new Date().getFullYear() + 1;
        const end = 1970;
        let options = "";
        for(let year = start ; year >=end; year--){
          options += "<option ";
          {% if year %}
          if(year === {{ year }}){
              options += "selected ";
          }
          {% else %}
          if(year === start - 1){
              options += "selected ";
          }
          {% endif %}
          options += "value=\""+ year + "\">" + year + " â†’ " + (year + 1) + "</option>";
        }
        document.getElementById("year").innerHTML = options;
    </script>
{% endblock %}
